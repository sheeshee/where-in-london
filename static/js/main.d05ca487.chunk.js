(this["webpackJsonpwhere-in-london"]=this["webpackJsonpwhere-in-london"]||[]).push([[0],{167:function(t,e,a){},168:function(t,e,a){},169:function(t,e,a){},170:function(t,e,a){},317:function(t,e,a){"use strict";a.r(e);var o=a(7),n=a(0),r=a.n(n),i=a(39),c=a.n(i),s=(a(167),a(19)),u=a(20),h=a(8),l=a(28),d=a(27),p=(a(168),a(169),a(44)),g=(a(170),a(45));function j(t){var e=Object(p.a)(t.toString()).reverse().join("").match(/.{1,3}/g);return"\xa3"+Object(p.a)(e.join(",")).reverse().join("")}var b=function(t){Object(l.a)(a,t);var e=Object(d.a)(a);function a(){return Object(s.a)(this,a),e.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return Object(o.jsx)("div",{className:"plot",children:this.props.data?Object(o.jsxs)(g.c,{width:375,height:200,margin:{left:40,right:50,top:25},data:this.props.data,children:[Object(o.jsx)(g.b,{dataKey:this.props.boroughKey,dot:!1}),Object(o.jsx)(g.a,{}),Object(o.jsx)(g.d,{dataKey:"date"}),Object(o.jsx)(g.e,{type:"number",tickFormatter:j})]}):Object(o.jsx)("div",{children:"Loading..."})})}}]),a}(n.Component);var f=function(t){Object(l.a)(a,t);var e=Object(d.a)(a);function a(t){var o;return Object(s.a)(this,a),(o=e.call(this,t)).state={data:null},o}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var t=this;fetch("/where-in-london/data/average-house-prices.json").then((function(t){return t.json()})).then((function(e){t.setState({data:e}),console.log("Loaded price data!")})).catch((function(t){return console.error("Could not load data:\n",t)}))}},{key:"render",value:function(){return Object(o.jsxs)("div",{className:"control-box",children:[Object(o.jsx)(b,{data:this.state.data,boroughKey:(t=this.props.boroughName,t.replace(" and "," & "))}),Object(o.jsx)("div",{children:this.props.boroughName?this.props.boroughName:"Hover over a borough to display its graph."})]});var t}}]),a}(n.Component),m=a(11),O=a(319),v=a(321),y=a(320),x=Object(m.latLngBounds)(Object(m.latLng)(51,-1),Object(m.latLng)(52,1)),B=function(t){Object(l.a)(a,t);var e=Object(d.a)(a);function a(t){var o;return Object(s.a)(this,a),(o=e.call(this,t)).style=function(t){return{fillColor:o.props.gradient.colorFromValue(t.properties.latest_average_price),weight:2,opacity:.5,color:"black",dashArray:"10",fillOpacity:.8}},o.onEachFeature=function(t,e){e.on({mouseover:o.highlightFeature.bind(Object(h.a)(o)),mouseout:o.resetHighlight.bind(Object(h.a)(o)),click:o.clickOnFeature.bind(Object(h.a)(o))})},o.highlightFeature=function(t){var e=t.target;o.props.updateBoroughName(e.feature.properties.name),o.props.updateBoroughSize(e.feature.properties.latest_average_price),e.setStyle({fillOpacity:1})},o.resetHighlight=function(t){o.props.updateBoroughName(""),o.geojsonRef.current.leafletElement.resetStyle(t.target)},o.clickOnFeature=function(t){var e=t.target;console.log("Clicked on "+e.feature.properties.name)},o.geojsonRef=r.a.createRef(),o.state={lat:51.505,lng:-.09,zoom:10},o}return Object(u.a)(a,[{key:"render",value:function(){var t=[this.state.lat,this.state.lng];return Object(o.jsxs)(O.a,{center:t,zoom:this.state.zoom,minZoom:10,maxBounds:x,children:[Object(o.jsx)(v.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.props.data?Object(o.jsx)(y.a,{ref:this.geojsonRef,data:this.props.data,style:this.style,onEachFeature:this.onEachFeature.bind(this)}):null]})}}]),a}(n.Component),S=a(157),k=a.n(S),F=function t(e){var a=this;Object(s.a)(this,t),this.getRank=function(t){return(t-a.minValue)/(a.maxValue-a.minValue)*100},this.colorFromValue=function(t){var e=a.getRank(t);return a.colorFromRank(e)},this.colorFromRank=function(t){return"#".concat(a.gradient.colorAt(t))},this.maxValue=Math.max.apply(Math,Object(p.a)(e)),this.minValue=Math.min.apply(Math,Object(p.a)(e)),this.gradient=new k.a,this.gradient.setSpectrum("green","red")},N=function(t){Object(l.a)(a,t);var e=Object(d.a)(a);function a(t){var o;return Object(s.a)(this,a),(o=e.call(this,t)).updateBoroughName=function(t){o.setState({selectedBoroughName:t})},o.updateBoroughSize=function(t){o.setState({selectedBoroughSize:t})},o.updateBoroughName=o.updateBoroughName.bind(Object(h.a)(o)),o.updateBoroughSize=o.updateBoroughSize.bind(Object(h.a)(o)),o.state={selectedBoroughName:"",selectedBoroughSize:0,data:null,areas:null},console.log("App Constructed"),o}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var t=this;fetch("/where-in-london/data/london_boroughs.json").then((function(t){return t.json()})).then((function(e){console.log("Loaded boroughs!");var a=e.features.map((function(t){return parseFloat(t.properties.latest_average_price)}));t.setState({data:e,areas:a})})).catch((function(t){return console.error("Failed to load data:\n",t)}))}},{key:"render",value:function(){if(this.state.data)var t=new F(this.state.areas),e=Object(o.jsx)(f,{boroughName:this.state.selectedBoroughName,boroughSize:this.state.selectedBoroughSize,gradient:t});return Object(o.jsxs)("div",{children:[e,Object(o.jsx)(B,{gradient:t,data:this.state.data,updateBoroughName:this.updateBoroughName,updateBoroughSize:this.updateBoroughSize})]})}}]),a}(n.Component),z=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,322)).then((function(e){var a=e.getCLS,o=e.getFID,n=e.getFCP,r=e.getLCP,i=e.getTTFB;a(t),o(t),n(t),r(t),i(t)}))};c.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(N,{})}),document.getElementById("root")),z()}},[[317,1,2]]]);
//# sourceMappingURL=main.d05ca487.chunk.js.map