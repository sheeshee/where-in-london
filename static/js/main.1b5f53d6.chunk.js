(this["webpackJsonpwhere-in-london"]=this["webpackJsonpwhere-in-london"]||[]).push([[0],{167:function(t,e,o){},168:function(t,e,o){},169:function(t,e,o){},170:function(t,e,o){},317:function(t,e,o){"use strict";o.r(e);var a=o(7),n=o(0),r=o.n(n),i=o(39),c=o.n(i),s=(o(167),o(19)),u=o(20),h=o(8),l=o(28),d=o(27),p=(o(168),o(169),o(44)),g=(o(170),o(45));function j(t){var e=Object(p.a)(t.toString()).reverse().join("").match(/.{1,3}/g);return"\xa3"+Object(p.a)(e.join(",")).reverse().join("")}var b=function(t){Object(l.a)(o,t);var e=Object(d.a)(o);function o(){return Object(s.a)(this,o),e.apply(this,arguments)}return Object(u.a)(o,[{key:"render",value:function(){return Object(a.jsx)("div",{className:"plot",children:this.props.data?Object(a.jsxs)(g.c,{width:375,height:200,margin:{left:40,right:50,top:25},data:this.props.data,children:[Object(a.jsx)(g.b,{dataKey:this.props.boroughKey,dot:!1}),Object(a.jsx)(g.a,{}),Object(a.jsx)(g.d,{dataKey:"date"}),Object(a.jsx)(g.e,{type:"number",tickFormatter:j})]}):Object(a.jsx)("div",{children:"Loading..."})})}}]),o}(n.Component);var f=function(t){Object(l.a)(o,t);var e=Object(d.a)(o);function o(t){var a;return Object(s.a)(this,o),(a=e.call(this,t)).state={data:null},a}return Object(u.a)(o,[{key:"componentDidMount",value:function(){var t=this;fetch("/where-in-london/data/average-house-prices.json").then((function(t){return t.json()})).then((function(e){t.setState({data:e}),console.log("Loaded price data!")})).catch((function(t){return console.error("Could not load data:\n",t)}))}},{key:"render",value:function(){return Object(a.jsxs)("div",{className:"control-box",children:[Object(a.jsx)(b,{data:this.state.data,boroughKey:(t=this.props.boroughName,t.replace(" and "," & "))}),Object(a.jsx)("div",{children:this.props.boroughName?this.props.boroughName:"Hover over a borough to display its graph."})]});var t}}]),o}(n.Component),m=o(11),O=o(319),v=o(321),y=o(320),x=Object(m.latLngBounds)(Object(m.latLng)(51,-1),Object(m.latLng)(52,1)),B=function(t){Object(l.a)(o,t);var e=Object(d.a)(o);function o(t){var a;return Object(s.a)(this,o),(a=e.call(this,t)).style=function(t){return{fillColor:a.getColor(t.properties.latest_average_price),weight:2,opacity:.5,color:"black",dashArray:"10",fillOpacity:.8}},a.getColor=function(t){try{return a.props.gradient.colorFromValue(t)}catch(e){return console.error("Could not get a color value!\n",e),0}},a.onEachFeature=function(t,e){e.on({mouseover:a.highlightFeature.bind(Object(h.a)(a)),mouseout:a.resetHighlight.bind(Object(h.a)(a)),click:a.clickOnFeature.bind(Object(h.a)(a))})},a.highlightFeature=function(t){var e=t.target;a.props.updateBoroughName(e.feature.properties.name),a.props.updateBoroughSize(e.feature.properties.latest_average_price),e.setStyle({fillOpacity:1})},a.resetHighlight=function(t){a.props.updateBoroughName(""),a.geojsonRef.current.leafletElement.resetStyle(t.target)},a.clickOnFeature=function(t){var e=t.target;console.log("Clicked on "+e.feature.properties.name)},a.geojsonRef=r.a.createRef(),a.state={lat:51.505,lng:-.09,zoom:10},a}return Object(u.a)(o,[{key:"render",value:function(){var t=[this.state.lat,this.state.lng];return Object(a.jsxs)(O.a,{center:t,zoom:this.state.zoom,minZoom:10,maxBounds:x,children:[Object(a.jsx)(v.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.props.data?Object(a.jsx)(y.a,{ref:this.geojsonRef,data:this.props.data,style:this.style,onEachFeature:this.onEachFeature.bind(this)}):null]})}}]),o}(n.Component),S=o(157),k=o.n(S),F=function t(e){var o=this;Object(s.a)(this,t),this.getRank=function(t){return(t-o.minValue)/(o.maxValue-o.minValue)*100},this.colorFromValue=function(t){var e=o.getRank(t);return o.colorFromRank(e)},this.colorFromRank=function(t){return"#".concat(o.gradient.colorAt(t))},this.maxValue=Math.max.apply(Math,Object(p.a)(e)),this.minValue=Math.min.apply(Math,Object(p.a)(e)),this.gradient=new k.a,this.gradient.setSpectrum("green","red")},N=function(t){Object(l.a)(o,t);var e=Object(d.a)(o);function o(t){var a;return Object(s.a)(this,o),(a=e.call(this,t)).updateBoroughName=function(t){a.setState({selectedBoroughName:t})},a.updateBoroughSize=function(t){a.setState({selectedBoroughSize:t})},a.updateBoroughName=a.updateBoroughName.bind(Object(h.a)(a)),a.updateBoroughSize=a.updateBoroughSize.bind(Object(h.a)(a)),a.state={selectedBoroughName:"",selectedBoroughSize:0,data:null,prices:null},console.log("App Constructed"),a}return Object(u.a)(o,[{key:"componentDidMount",value:function(){var t=this;fetch("/where-in-london/data/london_boroughs.json").then((function(t){return t.json()})).then((function(e){console.log("Loaded boroughs!");var o=e.features.map((function(t){return parseFloat(t.properties.latest_average_price)}));t.setState({data:e,prices:o})})).catch((function(t){return console.error("Failed to load data:\n",t)}))}},{key:"render",value:function(){if(this.state.data)var t=new F(this.state.prices),e=Object(a.jsx)(f,{boroughName:this.state.selectedBoroughName,boroughSize:this.state.selectedBoroughSize,gradient:t});return Object(a.jsxs)("div",{children:[e,Object(a.jsx)(B,{gradient:t,data:this.state.data,updateBoroughName:this.updateBoroughName,updateBoroughSize:this.updateBoroughSize})]})}}]),o}(n.Component),z=function(t){t&&t instanceof Function&&o.e(3).then(o.bind(null,322)).then((function(e){var o=e.getCLS,a=e.getFID,n=e.getFCP,r=e.getLCP,i=e.getTTFB;o(t),a(t),n(t),r(t),i(t)}))};c.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(N,{})}),document.getElementById("root")),z()}},[[317,1,2]]]);
//# sourceMappingURL=main.1b5f53d6.chunk.js.map